# Log4j2 configuration for Flink Health Data Consumer
# This configuration provides structured logging for Flink's Java components

################################################################################
# Root Logger Configuration
################################################################################

# Root logger level (can be overridden by LOG_LEVEL environment variable)
rootLogger.level = INFO
rootLogger.appenderRef.console.ref = ConsoleAppender
rootLogger.appenderRef.file.ref = FileAppender

################################################################################
# Console Appender
################################################################################

appender.console.name = ConsoleAppender
appender.console.type = Console
appender.console.target = SYSTEM_OUT
appender.console.layout.type = PatternLayout
appender.console.layout.pattern = %d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %-60c %x - %m%n

################################################################################
# File Appender with Rolling
################################################################################

appender.file.name = FileAppender
appender.file.type = RollingFile
appender.file.fileName = ${sys:log.file:-/tmp/flink-logs/flink-health-consumer.log}
appender.file.filePattern = ${sys:log.file:-/tmp/flink-logs/flink-health-consumer}.%d{yyyy-MM-dd}.%i.log.gz
appender.file.layout.type = PatternLayout
appender.file.layout.pattern = %d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %-60c %x - %m%n

# Rolling policy
appender.file.policies.type = Policies
appender.file.policies.time.type = TimeBasedTriggeringPolicy
appender.file.policies.time.interval = 1
appender.file.policies.time.modulate = true
appender.file.policies.size.type = SizeBasedTriggeringPolicy
appender.file.policies.size.size = 100MB

# Rollover strategy
appender.file.strategy.type = DefaultRolloverStrategy
appender.file.strategy.max = 10

################################################################################
# JSON Appender (Optional - for structured logging)
################################################################################

# Uncomment to enable JSON logging
# appender.json.name = JsonAppender
# appender.json.type = RollingFile
# appender.json.fileName = ${sys:log.file:-/tmp/flink-logs/flink-health-consumer-json.log}
# appender.json.filePattern = ${sys:log.file:-/tmp/flink-logs/flink-health-consumer-json}.%d{yyyy-MM-dd}.%i.log.gz
# appender.json.layout.type = JsonLayout
# appender.json.layout.compact = true
# appender.json.layout.eventEol = true
# appender.json.layout.properties = true
# appender.json.policies.type = Policies
# appender.json.policies.time.type = TimeBasedTriggeringPolicy
# appender.json.policies.size.type = SizeBasedTriggeringPolicy
# appender.json.policies.size.size = 100MB
# appender.json.strategy.type = DefaultRolloverStrategy
# appender.json.strategy.max = 10

################################################################################
# Logger Levels - Flink Components
################################################################################

# Flink core
logger.flink.name = org.apache.flink
logger.flink.level = INFO

# Flink runtime
logger.runtime.name = org.apache.flink.runtime
logger.runtime.level = INFO

# Flink streaming
logger.streaming.name = org.apache.flink.streaming
logger.streaming.level = INFO

# Flink state
logger.state.name = org.apache.flink.runtime.state
logger.state.level = INFO

# Flink checkpoint
logger.checkpoint.name = org.apache.flink.runtime.checkpoint
logger.checkpoint.level = INFO

# Flink metrics
logger.metrics.name = org.apache.flink.metrics
logger.metrics.level = INFO

################################################################################
# Logger Levels - Kafka
################################################################################

# Kafka clients
logger.kafka.name = org.apache.kafka
logger.kafka.level = WARN

# Kafka consumer
logger.kafkaConsumer.name = org.apache.kafka.clients.consumer
logger.kafkaConsumer.level = WARN

# Kafka producer
logger.kafkaProducer.name = org.apache.kafka.clients.producer
logger.kafkaProducer.level = WARN

################################################################################
# Logger Levels - Iceberg
################################################################################

# Iceberg core
logger.iceberg.name = org.apache.iceberg
logger.iceberg.level = INFO

# Iceberg Flink
logger.icebergFlink.name = org.apache.iceberg.flink
logger.icebergFlink.level = INFO

################################################################################
# Logger Levels - Hadoop/S3
################################################################################

# Hadoop
logger.hadoop.name = org.apache.hadoop
logger.hadoop.level = WARN

# AWS SDK
logger.aws.name = com.amazonaws
logger.aws.level = WARN

# S3A filesystem
logger.s3a.name = org.apache.hadoop.fs.s3a
logger.s3a.level = WARN

################################################################################
# Logger Levels - Other Dependencies
################################################################################

# Netty
logger.netty.name = io.netty
logger.netty.level = WARN

# Akka
logger.akka.name = akka
logger.akka.level = WARN

# Zookeeper
logger.zookeeper.name = org.apache.zookeeper
logger.zookeeper.level = WARN

# Curator
logger.curator.name = org.apache.curator
logger.curator.level = WARN

################################################################################
# Logger Levels - Application Specific
################################################################################

# Health data consumer application
logger.app.name = flink_consumer
logger.app.level = INFO

# Validation
logger.validation.name = flink_consumer.validators
logger.validation.level = INFO

# Transformation
logger.transformation.name = flink_consumer.converters
logger.transformation.level = INFO

# Kafka source
logger.source.name = flink_consumer.services.kafka_source
logger.source.level = INFO

# Iceberg sink
logger.sink.name = flink_consumer.iceberg
logger.sink.level = INFO

# Metrics
logger.appMetrics.name = flink_consumer.services.metrics
logger.appMetrics.level = INFO

################################################################################
# Suppress Verbose Logging
################################################################################

# Suppress verbose Netty logging
logger.nettyUtil.name = io.netty.util.internal
logger.nettyUtil.level = ERROR

# Suppress verbose Hadoop logging
logger.hadoopUtil.name = org.apache.hadoop.util.NativeCodeLoader
logger.hadoopUtil.level = ERROR

# Suppress verbose S3 logging
logger.s3aImpl.name = org.apache.hadoop.fs.s3a.S3AFileSystem
logger.s3aImpl.level = WARN

################################################################################
# Async Logging (Optional - for better performance)
################################################################################

# Uncomment to enable async logging
# rootLogger.appenderRef.async.ref = AsyncAppender
# 
# appender.async.name = AsyncAppender
# appender.async.type = Async
# appender.async.appenderRef.console.ref = ConsoleAppender
# appender.async.appenderRef.file.ref = FileAppender
# appender.async.bufferSize = 8192
# appender.async.blocking = false

################################################################################
# Environment-based Configuration
################################################################################

# Log level can be overridden by environment variable
# Example: LOG_LEVEL=DEBUG
# This is handled by the application startup script
